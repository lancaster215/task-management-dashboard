{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 33, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Francisco%20Ifurung/Desktop/to-do-app/src/lib/db.ts"],"sourcesContent":["import { Pool } from \"pg\";\r\n\r\ndeclare global {\r\n  // allow attaching pgPool to globalThis in Node and browsers during dev\r\n  // eslint-disable-next-line no-var\r\n  var pgPool: Pool | undefined;\r\n}\r\n\r\nlet pool: Pool;\r\n\r\nif (!globalThis.pgPool) {\r\n  globalThis.pgPool = new Pool({\r\n    connectionString: process.env.DATABASE_URL,\r\n    ssl: {\r\n      rejectUnauthorized: false,\r\n    },\r\n  });\r\n}\r\n\r\npool = globalThis.pgPool!;\r\n\r\nexport default pool;\r\n"],"names":[],"mappings":";;;AAAA;;;;;;AAQA,IAAI;AAEJ,IAAI,CAAC,WAAW,MAAM,EAAE;IACtB,WAAW,MAAM,GAAG,IAAI,oGAAA,CAAA,OAAI,CAAC;QAC3B,kBAAkB,QAAQ,GAAG,CAAC,YAAY;QAC1C,KAAK;YACH,oBAAoB;QACtB;IACF;AACF;AAEA,OAAO,WAAW,MAAM;uCAET","debugId":null}},
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Francisco%20Ifurung/Desktop/to-do-app/src/pages/api/custom/limiter.ts"],"sourcesContent":["// pages/api/custom/limiter.ts\r\nconst requests: Record<string, number[]> = {};\r\n\r\nexport default function isAllowed(ip: string, limit: number, windowMs: number): boolean {\r\n  const now = Date.now();\r\n  if (!requests[ip]) requests[ip] = [];\r\n\r\n  // Remove old requests outside the window\r\n  requests[ip] = requests[ip].filter(timestamp => now - timestamp < windowMs);\r\n\r\n  if (requests[ip].length >= limit) {\r\n    return false;\r\n  }\r\n\r\n  requests[ip].push(now);\r\n  return true;\r\n}\r\n"],"names":[],"mappings":"AAAA,8BAA8B;;;;AAC9B,MAAM,WAAqC,CAAC;AAE7B,SAAS,UAAU,EAAU,EAAE,KAAa,EAAE,QAAgB;IAC3E,MAAM,MAAM,KAAK,GAAG;IACpB,IAAI,CAAC,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC,GAAG,GAAG,EAAE;IAEpC,yCAAyC;IACzC,QAAQ,CAAC,GAAG,GAAG,QAAQ,CAAC,GAAG,CAAC,MAAM,CAAC,CAAA,YAAa,MAAM,YAAY;IAElE,IAAI,QAAQ,CAAC,GAAG,CAAC,MAAM,IAAI,OAAO;QAChC,OAAO;IACT;IAEA,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC;IAClB,OAAO;AACT","debugId":null}},
    {"offset": {"line": 80, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Francisco%20Ifurung/Desktop/to-do-app/src/pages/api/task.ts"],"sourcesContent":["import pool from \"@/lib/db\";\r\nimport type { NextApiRequest, NextApiResponse } from \"next\";\r\nimport isAllowed from \"./custom/limiter\";\r\n\r\nexport default async function handler(req: NextApiRequest, res: NextApiResponse) {\r\n    const ip = req.headers['x-forwarded-for'] || req.socket.remoteAddress || 'unknown';\r\n\r\n    if(!isAllowed(String(ip), 5, 10000)) {\r\n        return res.status(429).json({ message: 'Too many requests. Try again later.' });\r\n    }\r\n\r\n    try {\r\n        const result = await pool.query('SELECT * FROM \"Task\" ORDER BY id DESC');\r\n\r\n        res.status(200).json(result.rows)\r\n    } catch(err) {\r\n        console.log(err)\r\n    }\r\n}"],"names":[],"mappings":";;;AAAA;AAEA;;;;;;;AAEe,eAAe,QAAQ,GAAmB,EAAE,GAAoB;IAC3E,MAAM,KAAK,IAAI,OAAO,CAAC,kBAAkB,IAAI,IAAI,MAAM,CAAC,aAAa,IAAI;IAEzE,IAAG,CAAC,CAAA,GAAA,iIAAA,CAAA,UAAS,AAAD,EAAE,OAAO,KAAK,GAAG,QAAQ;QACjC,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,SAAS;QAAsC;IACjF;IAEA,IAAI;QACA,MAAM,SAAS,MAAM,yGAAA,CAAA,UAAI,CAAC,KAAK,CAAC;QAEhC,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC,OAAO,IAAI;IACpC,EAAE,OAAM,KAAK;QACT,QAAQ,GAAG,CAAC;IAChB;AACJ","debugId":null}}]
}